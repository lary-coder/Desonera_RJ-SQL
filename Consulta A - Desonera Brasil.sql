SELECT
v.cnae_2_subclasse AS CNAE,
SUM(CASE WHEN v.ano = 2013 THEN v.quantidade_vinculos_ativos ELSE 0 END) AS Empregos_2013,
SUM(CASE WHEN v.ano = 2014 THEN v.quantidade_vinculos_ativos ELSE 0 END) AS Empregos_2014,
SUM(CASE WHEN v.ano = 2015 THEN v.quantidade_vinculos_ativos ELSE 0 END) AS Empregos_2015,
SUM(CASE WHEN v.ano = 2016 THEN v.quantidade_vinculos_ativos ELSE 0 END) AS Empregos_2016,
SUM(CASE WHEN v.ano = 2017 THEN v.quantidade_vinculos_ativos ELSE 0 END) AS Empregos_2017,
SUM(CASE WHEN v.ano = 2018 THEN v.quantidade_vinculos_ativos ELSE 0 END) AS Empregos_2018,
SUM(CASE WHEN v.ano = 2019 THEN v.quantidade_vinculos_ativos ELSE 0 END) AS Empregos_2019,
SUM(CASE WHEN v.ano = 2020 THEN v.quantidade_vinculos_ativos ELSE 0 END) AS Empregos_2020,
SUM(CASE WHEN v.ano = 2021 THEN v.quantidade_vinculos_ativos ELSE 0 END) AS Empregos_2021,
SUM(CASE WHEN v.ano = 2022 THEN v.quantidade_vinculos_ativos ELSE 0 END) AS Empregos_2022,
v.sigla_uf AS UF
FROM
basedosdados.br_me_rais.microdados_estabelecimentos v
WHERE
v.cnae_2_subclasse IS NOT NULL
AND v.cnae_2_subclasse IN (
'1811301', '1811302', '3311200', '3312102', '3312103', '3312104', '3313901', '3313902', '3313999', '3314701', '3314702', '3314703', '3314704', '3314705', '3316301', '3316302', '3317101', '3317102', '3319800', '3321000', '3329501', '3329599', '4120400', '4211101', '4211102', '4212000', '4213800', '4221901', '4221902', '4221903', '4221904', '4221905', '4222701', '4222702', '4223500', '4291000', '4292801', '4292802', '4299501', '4299599', '4311801', '4311802', '4312600', '4313400', '4319300', '4321500', '4322301', '4322302', '4322303', '4329101', '4329102', '4329103', '4329104', '4329105', '4329199', '4330401', '4330402', '4330403', '4330404', '4330405', '4330499', '4391600', '4399101', '4399102', '4399103', '4399104', '4399105', '4399199', '4713001', '4744005', '4744099', '4751200', '4751201', '4752100', '4753900', '4754701', '4755501', '4755502', '4755503', '4759801', '4759899', '4761001', '4761002', '4761003', '4762800', '4763601', '4763602', '4772500', '4781400', '4782201', '4782202', '4789005', '4789008', '4911600', '4912401', '4912402', '4912403', '4921301', '4921302', '4922101', '4922102', '4922103', '4929901', '4929902', '4929903', '4929904', '4929999', '4930201', '4930202', '4930203', '4930204', '5011401', '5011402', '5012201', '5012202', '5021101', '5021102', '5022001', '5022002', '5030101', '5030102', '5111100', '5112901', '5112999', '5120000', '5130700', '5212500', '5231101', '5231102', '5232000', '5240101', '5240199', '5510801', '5811500', '5812300', '5812301', '5812302', '5813100', '5822100', '5822101', '5822102', '5823900', '6010100', '6021700', '6110801', '6110802', '6110803', '6110899', '6120501', '6120502', '6120599', '6130200', '6141800', '6142600', '6143400', '6190601', '6190602', '6190699', '6201500', '6201501', '6202300', '6203100', '6204000', '6209100', '6311900', '6391700', '6319400', '6399200', '7111100', '7112000', '7119701', '7119702', '7119703', '7119704', '7119799', '8220200'
)
AND v.quantidade_vinculos_ativos IS NOT NULL
GROUP BY
v.cnae_2_subclasse, v.sigla_uf
ORDER BY
CNAE ASC;
